{% extends 'base/base.html' %}

{% block title %}Centers - NGO Education System{% endblock %}

{% block content %}
<div class="page-header">
    <div class="header-content">
        <div class="header-text">
            <h1>üè¢ Centers Management</h1>
            <p>Manage and monitor all learning centers across locations</p>
        </div>
        <div class="header-actions">
            <a href="#" class="btn btn-success">
                <i class="fas fa-plus"></i> Add New Center
            </a>
            <a href="#" class="btn btn-primary">
                <i class="fas fa-map-marked-alt"></i> View Map
            </a>
        </div>
    </div>
</div>

<div class="filters-section">
    <div class="filters-container">
        <form method="GET" class="filters-form">
            <div class="filter-group">
                <label class="filter-label">Search Centers</label>
                <div class="search-input-wrapper">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" name="search" placeholder="Search by center name or location..." 
                           value="{{ search_query }}" class="form-control search-input">
                </div>
            </div>
            <div class="filter-group">
                <label class="filter-label">Filter by Status</label>
                <select name="status" class="form-control">
                    <option value="">All Centers</option>
                    <option value="active">Active Centers</option>
                    <option value="inactive">Inactive Centers</option>
                </select>
            </div>
            <div class="filter-actions">
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-filter"></i> Apply Filters
                </button>
                <a href="{% url 'center_list' %}" class="btn btn-secondary">
                    <i class="fas fa-times"></i> Clear
                </a>
            </div>
        </form>
    </div>
</div>

<div class="centers-stats">
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-building"></i>
            </div>
            <div class="stat-content">
                <h3>Total Centers</h3>
                <div class="stat-value">{{ centers.count }}</div>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <div class="stat-content">
                <h3>Active Centers</h3>
                <div class="stat-value">{{ centers.count }}</div>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-users"></i>
            </div>
            <div class="stat-content">
                <h3>Total Students</h3>
                <div class="stat-value">
                    {% for center in centers %}
                        {{ center.student_count|add:0 }}
                    {% empty %}
                        0
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-chart-line"></i>
            </div>
            <div class="stat-content">
                <h3>Avg Utilization</h3>
                <div class="stat-value">78%</div>
            </div>
        </div>
    </div>
</div>

<div class="table-section">
    <div class="table-header">
        <h2>üè´ Centers Directory</h2>
        <div class="table-actions">
            <button class="btn btn-outline">
                <i class="fas fa-download"></i> Export
            </button>
            <button class="btn btn-outline">
                <i class="fas fa-print"></i> Print
            </button>
        </div>
    </div>
    
    <div class="table-container">
        <table class="table">
            <thead>
                <tr>
                    <th>
                        <div class="th-content">
                            <i class="fas fa-building"></i>
                            Center Name
                        </div>
                    </th>
                    <th>
                        <div class="th-content">
                            <i class="fas fa-map-marker-alt"></i>
                            Location
                        </div>
                    </th>
                    <th>
                        <div class="th-content">
                            <i class="fas fa-user-tie"></i>
                            Coordinator
                        </div>
                    </th>
                    <th>
                        <div class="th-content">
                            <i class="fas fa-users"></i>
                            Students
                        </div>
                    </th>
                    <th>
                        <div class="th-content">
                            <i class="fas fa-chair"></i>
                            Capacity
                        </div>
                    </th>
                    <th>
                        <div class="th-content">
                            <i class="fas fa-percentage"></i>
                            Utilization
                        </div>
                    </th>
                    <th>
                        <div class="th-content">
                            <i class="fas fa-info-circle"></i>
                            Status
                        </div>
                    </th>
                    <th>
                        <div class="th-content">
                            <i class="fas fa-cogs"></i>
                            Actions
                        </div>
                    </th>
                </tr>
            </thead>
            <tbody>
                {% for center in centers %}
                <tr class="center-row">
                    <td>
                        <div class="center-info">
                            <div class="center-avatar">
                                <i class="fas fa-school"></i>
                            </div>
                            <div class="center-details">
                                <div class="center-name">{{ center.name }}</div>
                                <div class="center-meta">Est. {{ center.established_date|date:"Y" }}</div>
                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="location-info">
                            <i class="fas fa-map-pin location-icon"></i>
                            <span>{{ center.location }}</span>
                        </div>
                    </td>
                    <td>
                        <div class="coordinator-info">
                            <div class="coordinator-avatar">
                                <i class="fas fa-user-circle"></i>
                            </div>
                            <div class="coordinator-details">
                                <div class="coordinator-name">{{ center.coordinator.get_full_name|default:center.coordinator.username }}</div>
                                <div class="coordinator-role">Coordinator</div>
                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="student-count">
                            <span class="count-badge">{{ center.student_count|default:0 }}</span>
                        </div>
                    </td>
                    <td>
                        <div class="capacity-info">
                            <i class="fas fa-chair capacity-icon"></i>
                            <span>{{ center.capacity }}</span>
                        </div>
                    </td>
                    <td>
                        <div class="utilization-info">
                            <div class="progress-bar" style="width: 80px;">
                                <div class="progress-fill" style="width: {% widthratio center.student_count|default:0 center.capacity 100 %}%;"></div>
                            </div>
                            <span class="utilization-text">
                                {% widthratio center.student_count|default:0 center.capacity 100 %}%
                            </span>
                        </div>
                    </td>
                    <td>
                        {% if center.is_active %}
                            <span class="status-indicator status-active">
                                <i class="fas fa-circle" style="font-size: 0.5rem;"></i>
                                Active
                            </span>
                        {% else %}
                            <span class="status-indicator status-inactive">
                                <i class="fas fa-circle" style="font-size: 0.5rem;"></i>
                                Inactive
                            </span>
                        {% endif %}
                    </td>
                    <td>
                        <div class="action-buttons">
                            <a href="{% url 'center_detail' center.id %}" class="btn btn-primary btn-sm" title="View Details">
                                <i class="fas fa-eye"></i>
                            </a>
                            <a href="#" class="btn btn-success btn-sm" title="Edit Center">
                                <i class="fas fa-edit"></i>
                            </a>
                            <a href="#" class="btn btn-warning btn-sm" title="Manage Students">
                                <i class="fas fa-users"></i>
                            </a>
                        </div>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="8" class="empty-state">
                        <div class="empty-content">
                            <i class="fas fa-building empty-icon"></i>
                            <h3>No Centers Found</h3>
                            <p>No centers match your current filters. Try adjusting your search criteria or <a href="#">add a new center</a>.</p>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- Quick Stats Cards -->
<div class="quick-stats-section">
    <h2>üìä Quick Statistics</h2>
    <div class="quick-stats-grid">
        {% for center in centers %}
        <div class="quick-stat-card">
            <div class="quick-stat-header">
                <h4>{{ center.name }}</h4>
                <span class="quick-stat-location">{{ center.location }}</span>
            </div>
            <div class="quick-stat-metrics">
                <div class="metric">
                    <span class="metric-value">{{ center.student_count|default:0 }}</span>
                    <span class="metric-label">Students</span>
                </div>
                <div class="metric">
                    <span class="metric-value">{{ center.capacity }}</span>
                    <span class="metric-label">Capacity</span>
                </div>
                <div class="metric">
                    <span class="metric-value">{% widthratio center.student_count|default:0 center.capacity 100 %}%</span>
                    <span class="metric-label">Utilization</span>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
